<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Painel de Intelig√™ncia & Estrutura√ß√£o</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root {
            --primary-color: #34495e; /* Azul corporativo s√≥brio */
            --accent-color: #1abc9c; /* Verde para a√ß√µes */
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
            --gray-color: #7f8c8d;
            --white-color: #ffffff;
            --success-color: #27ae60;
            --font-main: 'Roboto', -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            --font-headings: 'Lato', serif;
        }
        @import url('https://fonts.googleapis.com/css2?family=Lato:wght@700&family=Roboto:wght@400;500;700&display=swap');
        *, *::before, *::after { box-sizing: border-box; }
        body { font-family: var(--font-main); margin: 0; padding: 0; background-color: var(--light-color); color: var(--dark-color); }
        .container { max-width: 800px; margin: 20px auto; background-color: var(--white-color); border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; }
        .header { background: var(--dark-color); color: var(--white-color); padding: 25px 30px; text-align: center; }
        .header h1 { font-family: var(--font-headings); margin: 0; font-size: 2.2em; color: var(--white-color); }
        .header p { margin: 5px 0 0; color: var(--light-color); opacity: 0.8; }
        .tab-navigation { display: flex; background-color: #34495e; }
        .tab-btn { flex: 1; padding: 15px; background: none; border: none; color: var(--light-color); font-size: 1.1em; font-weight: 500; cursor: pointer; transition: background-color 0.3s, color 0.3s; border-bottom: 3px solid transparent; }
        .tab-btn.active { background-color: var(--white-color); color: var(--dark-color); border-bottom-color: var(--accent-color); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .form-content { padding: 30px; }
        .form-section { margin-bottom: 40px; border: 1px solid #ddd; border-radius: 12px; overflow: hidden; background: var(--white-color); }
        .section-header { padding: 20px; background-color: #f9f9f9; border-bottom: 1px solid #ddd; display: flex; align-items: center; }
        .section-header h2 { font-family: var(--font-headings); margin: 0; font-size: 1.5em; color: var(--dark-color); }
        .section-header .icon { font-size: 1.5em; margin-right: 15px; color: var(--primary-color); }
        .section-body { padding: 25px; }
        .form-group { margin-bottom: 30px; }
        label { display: block; font-weight: 700; margin-bottom: 10px; font-size: 1.1em; }
        label small { display: block; font-weight: 400; color: var(--gray-color); font-size: 0.9em; margin-top: 5px; line-height: 1.5; }
        input, select, textarea { width: 100%; padding: 14px; border: 1px solid #ccc; border-radius: 8px; font-size: 1em; font-family: var(--font-main); background-color: #fafafa; transition: all 0.2s; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(52, 73, 94, 0.2); }
        textarea { resize: vertical; min-height: 120px; }
        .button-group { padding: 30px; background-color: #f0f0f0; border-top: 1px solid #ddd; }
        .btn { display: block; width: 100%; padding: 16px; border: none; border-radius: 8px; font-size: 1.2em; font-weight: 700; cursor: pointer; transition: all 0.3s; }
        .btn-primary { background-color: var(--primary-color); color: var(--white-color); }
        .btn-accent { background-color: var(--accent-color); color: var(--white-color); }
        
        /* Painel de Relat√≥rio */
        .report-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center; z-index: 1000; backdrop-filter: blur(8px); opacity: 0; transition: opacity 0.3s ease; }
        .report-panel { background: var(--dark-color); color: var(--white-color); width: 90%; max-width: 600px; max-height: 85vh; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); display: flex; flex-direction: column; transform: scale(0.95); transition: transform 0.3s ease; }
        .report-header { padding: 20px; border-bottom: 1px solid rgba(255, 255, 255, 0.2); display: flex; justify-content: space-between; align-items: center; }
        .report-header h2 { font-family: var(--font-headings); margin: 0; color: var(--accent-color); font-size: 1.5em; }
        .report-header .close-btn { font-size: 28px; color: #fff; cursor: pointer; border: none; background: none; }
        .report-body { padding: 25px; overflow-y: auto; white-space: pre-wrap; line-height: 1.8; font-size: 0.95em; }
        .report-footer { padding: 20px; border-top: 1px solid rgba(255, 255, 255, 0.2); }
        .btn-copy { background-color: var(--success-color); color: #fff; }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Painel de Intelig√™ncia</h1>
            <p>Gera√ß√£o de Briefings & S√≠ntese de Dados</p>
        </header>

        <nav class="tab-navigation">
            <button class="tab-btn active" data-tab="briefing">Gerador de Briefing</button>
            <button class="tab-btn" data-tab="synthesis">Sintetizador de Dados</button>
        </nav>
        
        <div id="settings" class="form-content" style="border-bottom: 1px solid #eee;">
            <div class="form-group">
                <label for="userName">Seu Identificador (para salvar na nuvem)</label>
                <input type="text" id="userName" placeholder="Ex: samir.pesquisa">
            </div>
             <div class="form-group">
                <label for="projectName">Nome do Projeto/Entrevista</label>
                <input type="text" id="projectName" placeholder="Ex: Entrevista com T√©cnico Setor P√∫blico">
            </div>
        </div>

        <div id="briefing" class="tab-content active">
            <form id="briefing-form">
                <div id="dynamic-form-content" class="form-content">
                    </div>
                <div class="button-group">
                    <button type="submit" class="btn btn-primary">Gerar e Salvar Briefing</button>
                </div>
            </form>
        </div>

        <div id="synthesis" class="tab-content">
            <div class="form-content">
                <div class="form-section">
                    <div class="section-header"><span class="icon">üìÑ</span><h2>M√≥dulo de S√≠ntese de Transcri√ß√µes</h2></div>
                    <div class="section-body">
                        <div class="form-group">
                            <label for="rawText">Cole aqui o texto bruto da transcri√ß√£o</label>
                            <small>Insira o texto completo, mesmo que esteja desorganizado.</small>
                            <textarea id="rawText" name="rawText" rows="10"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="categories">Defina as categorias para extra√ß√£o (separadas por v√≠rgula)</label>
                            <small>Ex: Dores do usu√°rio, Sugest√µes de melhoria, Principais desafios, Cita√ß√µes importantes</small>
                            <input type="text" id="categories" name="categories" value="Dores do usu√°rio, Sugest√µes de melhoria, Desafios mencionados">
                        </div>
                    </div>
                </div>
                 <div class="button-group">
                    <button id="generate-prompt-btn" type="button" class="btn btn-accent">Gerar Prompt de An√°lise</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="report-overlay" id="report-overlay">
        <div class="report-panel" id="report-panel">
            <div class="report-header">
                <h2 id="report-title">Relat√≥rio Gerado</h2>
                <button class="close-btn" id="close-report-btn">&times;</button>
            </div>
            <div class="report-body" id="report-output"></div>
            <div class="report-footer">
                <button class="btn btn-copy" id="copy-report-btn">Copiar</button>
            </div>
        </div>
    </div>

<script>
// --- CONFIGURA√á√ÉO FIREBASE ---
const firebaseConfig = {
    apiKey: "AIzaSyAo9iVQm_BzmvNLAUxc4pGL_qp6ic4JQfo",
    authDomain: "listas-de-compras-ff4a3.firebaseapp.com",
    databaseURL: "https://listas-de-compras-ff4a3-default-rtdb.firebaseio.com",
    projectId: "listas-de-compras-ff4a3",
    storageBucket: "listas-de-compras-ff4a3.firebasestorage.app",
    messagingSenderId: "623752672529",
    appId: "1:623752672529:web:ba43bfdad31f050da3c8b0"
};
firebase.initializeApp(firebaseConfig);
const database = firebase.database();

// --- CONFIGURA√á√ÉO DO BRIEFING CUSTOMIZ√ÅVEL ---
// Edite este objeto para mudar completamente o formul√°rio de briefing.
const briefingConfig = {
    modules: [
        {
            icon: "üéØ",
            title: "Objetivos Centrais",
            fields: [
                { id: "mainGoal", label: "Qual √© o objetivo principal deste projeto?", type: "textarea", placeholder: "Ex: Desenvolver um novo dashboard para o time de opera√ß√µes.", help: "Seja espec√≠fico. O que define o sucesso deste projeto?" },
                { id: "mainProblem", label: "Qual problema estamos resolvendo?", type: "textarea", placeholder: "Ex: O time atual perde muito tempo consolidando relat√≥rios manualmente.", help: "Descreva a 'dor' que o projeto vai curar." }
            ]
        },
        {
            icon: "üë•",
            title: "P√∫blico-Alvo e Stakeholders",
            fields: [
                { id: "targetAudience", label: "Quem √© o p√∫blico-alvo principal?", type: "text", placeholder: "Ex: Gestores de Opera√ß√µes.", help: "Para quem estamos fazendo isso?" },
                { id: "stakeholders", label: "Quem s√£o os stakeholders chave?", type: "text", placeholder: "Ex: Diretor de TI, Gerente de Produto.", help: "Quem precisa aprovar ou ser consultado?" }
            ]
        },
        {
            icon: "‚öôÔ∏è",
            title: "Requisitos e Restri√ß√µes",
            fields: [
                 { id: "coreFeatures", label: "Quais s√£o as funcionalidades essenciais (MVP)?", type: "textarea", placeholder: "1. Visualiza√ß√£o de dados em tempo real.\n2. Exporta√ß√£o para PDF.", help: "Liste o que √© inegoci√°vel para o lan√ßamento." },
                 { id: "restrictions", label: "Existem restri√ß√µes (or√ßamento, prazo, tecnologia)?", type: "textarea", placeholder: "Ex: O projeto deve ser conclu√≠do em 3 meses. Deve usar a stack de tecnologia atual da empresa.", help: "Quais s√£o as nossas limita√ß√µes?" }
            ]
        }
    ]
};

document.addEventListener('DOMContentLoaded', function() {
    // --- L√ìGICA DA APLICA√á√ÉO ---
    const briefingForm = document.getElementById('briefing-form');
    const dynamicFormContent = document.getElementById('dynamic-form-content');
    const overlay = document.getElementById('report-overlay');
    const panel = document.getElementById('report-panel');
    const closeBtn = document.getElementById('close-report-btn');
    const copyBtn = document.getElementById('copy-report-btn');
    const reportOutput = document.getElementById('report-output');
    const reportTitle = document.getElementById('report-title');

    // --- Renderiza√ß√£o do Formul√°rio Din√¢mico ---
    function renderDynamicForm() {
        let html = '';
        briefingConfig.modules.forEach(module => {
            html += `
                <div class="form-section">
                    <div class="section-header"><span class="icon">${module.icon}</span><h2>${module.title}</h2></div>
                    <div class="section-body">`;
            module.fields.forEach(field => {
                html += `
                    <div class="form-group">
                        <label for="${field.id}">${field.label}</label>
                        <small>${field.help}</small>`;
                if (field.type === 'textarea') {
                    html += `<textarea id="${field.id}" name="${field.id}" placeholder="${field.placeholder || ''}"></textarea>`;
                } else { // 'text' ou 'select' etc.
                    html += `<input type="text" id="${field.id}" name="${field.id}" placeholder="${field.placeholder || ''}">`;
                }
                html += `</div>`;
            });
            html += `</div></div>`;
        });
        dynamicFormContent.innerHTML = html;
    }

    // --- L√≥gica de Abas ---
    const tabButtons = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');
    tabButtons.forEach(button => {
        button.addEventListener('click', () => {
            tabButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            const tabId = button.dataset.tab;
            tabContents.forEach(content => {
                content.id === tabId ? content.classList.add('active') : content.classList.remove('active');
            });
        });
    });

    // --- Gera√ß√£o de Briefing ---
    briefingForm.addEventListener('submit', async function(event) {
        event.preventDefault();
        const userName = document.getElementById('userName').value.trim();
        const projectName = document.getElementById('projectName').value.trim();
        if (!userName || !projectName) {
            alert("Por favor, preencha o seu Identificador e o Nome do Projeto.");
            return;
        }

        const formData = new FormData(briefingForm);
        let briefingReport = `üìã RELAT√ìRIO DE BRIEFING üìã\n\n`;
        briefingReport += `Projeto: ${projectName}\n`;
        briefingReport += `Gerado por: ${userName}\n`;
        briefingReport += `Data: ${new Date().toLocaleString('pt-BR')}\n`;
        briefingReport += "========================================\n\n";

        briefingConfig.modules.forEach(module => {
            briefingReport += `--- ${module.title.toUpperCase()} ---\n`;
            module.fields.forEach(field => {
                briefingReport += `‚ñ∂ ${field.label}:\n`
                briefingReport += `${formData.get(field.id) || 'N√£o preenchido'}\n\n`;
            });
        });

        reportTitle.textContent = "Briefing Estrat√©gico";
        showReport(briefingReport);

        // Salvar no Firebase
        const briefingId = `${new Date().getTime()}-${projectName.replace(/\s+/g, '-')}`;
        try {
            await database.ref(`paineis-de-inteligencia/${userName}/${briefingId}`).set({
                projectName: projectName,
                createdAt: new Date().toISOString(),
                content: briefingReport
            });
            console.log("Briefing salvo com sucesso no Firebase!");
        } catch (error) {
            console.error("Erro ao salvar no Firebase: ", error);
            alert("Houve um erro ao salvar o briefing. Verifique o console.");
        }
    });

    // --- L√≥gica do Sintetizador de Dados ---
    document.getElementById('generate-prompt-btn').addEventListener('click', function() {
        const rawText = document.getElementById('rawText').value.trim();
        const categories = document.getElementById('categories').value.trim();

        if (!rawText || !categories) {
            alert("Por favor, preencha o texto bruto e as categorias.");
            return;
        }

        let prompt = `**TAREFA DE AN√ÅLISE E ESTRUTURA√á√ÉO DE TEXTO**\n\n`;
        prompt += `**OBJETIVO:** Analisar o texto bruto fornecido e extrair cita√ß√µes diretas (verbatim) que correspondam √†s categorias especificadas. A tarefa √© de ORGANIZA√á√ÉO, n√£o de sumariza√ß√£o ou reescrita.\n\n`;
        prompt += `**REGRAS CR√çTICAS:**\n`;
        prompt += `1.  **N√ÉO ALTERE O TEXTO ORIGINAL:** Copie e cole as frases ou par√°grafos exatos do texto original. N√£o corrija erros gramaticais, g√≠rias ou v√≠cios de linguagem (como "n√©", "certo?"). A fidelidade ao original √© m√°xima.\n`;
        prompt += `2.  **N√ÉO RESUMA NEM PARAFRASEIE:** O objetivo √© agrupar as informa√ß√µes como elas foram ditas, n√£o interpret√°-las.\n`;
        prompt += `3.  Se um trecho se encaixar em mais de uma categoria, voc√™ pode repeti-lo.\n`;
        prompt += `4.  Se nenhuma informa√ß√£o for encontrada para uma categoria, indique "Nenhuma informa√ß√£o encontrada nesta categoria."\n\n`;
        prompt += `**CATEGORIAS PARA EXTRA√á√ÉO:**\n- ${categories.split(',').map(c => c.trim()).join('\n- ')}\n\n`;
        prompt += `**TEXTO BRUTO PARA AN√ÅLISE:**\n---\n${rawText}\n---\n\n`;
        prompt += `**FORMATO DA SA√çDA ESPERADA:**\n\n`;
        prompt += `### Relat√≥rio de S√≠ntese da Entrevista\n\n`;
        categories.split(',').forEach(category => {
            prompt += `**${category.trim()}**\n- [Cita√ß√£o 1 extra√≠da do texto]\n- [Cita√ß√£o 2 extra√≠da do texto]\n\n`;
        });

        reportTitle.textContent = "Prompt de An√°lise Gerado";
        showReport(prompt);
    });

    // --- Fun√ß√µes do Painel de Relat√≥rio (Popup) ---
    function showReport(content) {
        reportOutput.textContent = content;
        overlay.style.display = 'flex';
        setTimeout(() => {
            overlay.style.opacity = 1;
            panel.style.transform = 'scale(1)';
        }, 10);
    }
    
    function closePanel() {
        overlay.style.opacity = 0;
        panel.style.transform = 'scale(0.95)';
        setTimeout(() => {
            overlay.style.display = 'none';
        }, 300);
    }

    closeBtn.addEventListener('click', closePanel);
    overlay.addEventListener('click', (event) => { if (event.target === overlay) closePanel(); });

    copyBtn.addEventListener('click', function() {
        navigator.clipboard.writeText(reportOutput.textContent).then(() => {
            copyBtn.textContent = 'Copiado com Sucesso!';
            copyBtn.style.backgroundColor = '#16a085';
            setTimeout(() => {
                copyBtn.textContent = 'Copiar';
                copyBtn.style.backgroundColor = 'var(--success-color)';
            }, 2000);
        }).catch(err => { console.error('Erro ao copiar: ', err); });
    });

    // --- Inicializa√ß√£o ---
    renderDynamicForm();
});
</script>
</body>
</html>
